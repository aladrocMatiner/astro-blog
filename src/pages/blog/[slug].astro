---
import Layout from '../../layouts/BaseLayout.astro';
import { getAllPosts, getPostBySlug } from '../../lib/posts';

export function getStaticPaths() {
  return getAllPosts().map((post) => ({
    params: {
      slug: post.slug
    }
  }));
}

const post = getPostBySlug(Astro.params.slug);

if (!post) {
  throw new Error(`Post not found: ${Astro.params.slug}`);
}

const { Content, title, summary, publishDate, tags } = post;
---
<Layout title={`${title} · Astro Tech Blog`}>
  <article style="display:flex; flex-direction:column; gap:1rem;">
    <header>
      <p style="margin:0; color:#94a3b8;">
        {new Date(publishDate).toLocaleDateString('es-ES', {
          day: 'numeric',
          month: 'long',
          year: 'numeric'
        })}
        {' · '}
        <span class="tag">{tags.join(' · ')}</span>
      </p>
      <h1 style="margin:0;">{title}</h1>
      <p style="margin:0; color:#cbd5f5;">{summary}</p>
    </header>
    <section>
      <Content />
    </section>
  </article>
</Layout>
